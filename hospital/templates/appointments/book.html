{% extends 'hospital/base.html' %}
{% block title %}Book Appointment - MedVita{% endblock %}
{% block content %}
<div class="page-hero"><div class="container"><h1>Book an Appointment</h1><p>Schedule a consultation with our specialist doctors</p><div class="breadcrumb"><a href="/">Home</a> / Book Appointment</div></div></div>
<section class="section">
  <div class="container" style="max-width:800px;">
    <div style="background:#fff;border-radius:20px;box-shadow:var(--shadow-lg);padding:48px;">
      {% if not user.is_authenticated %}
      <div class="alert alert-info">&#8505; Please <a href="/patients/login/?next=/appointments/book/" style="color:var(--teal);font-weight:600;">login</a> or <a href="/patients/register/" style="color:var(--teal);font-weight:600;">register</a> to complete booking.</div>
      {% endif %}
      <h2 style="color:var(--navy);margin-bottom:28px;">Appointment Details</h2>
      <form method="post" id="bookingForm">
        {% csrf_token %}
        <div class="form-group">
          <label>Select Doctor *</label>
          <select name="doctor" id="doctorSelect" class="form-control" required>
            <option value="">-- Choose a specialist --</option>
            {% for doctor in doctors %}
            <option value="{{ doctor.id }}" {% if selected_doctor and selected_doctor.id == doctor.id %}selected{% endif %}>{{ doctor.full_name }} -- {{ doctor.specialization }} (${{ doctor.consultation_fee }})</option>
            {% endfor %}
          </select>
        </div>
        <div class="grid-2" style="gap:16px;">
          <div class="form-group">
            <label>Appointment Date *</label>
            <input type="date" name="appointment_date" class="form-control" required id="apptDate">
          </div>
          <div class="form-group">
            <label>Appointment Time *</label>
            <select name="appointment_time" class="form-control" required>
              <option value="">Select a time</option>
              <option value="09:00:00">9:00 AM</option>
              <option value="09:30:00">9:30 AM</option>
              <option value="10:00:00">10:00 AM</option>
              <option value="10:30:00">10:30 AM</option>
              <option value="11:00:00">11:00 AM</option>
              <option value="11:30:00">11:30 AM</option>
              <option value="14:00:00">2:00 PM</option>
              <option value="14:30:00">2:30 PM</option>
              <option value="15:00:00">3:00 PM</option>
              <option value="15:30:00">3:30 PM</option>
              <option value="16:00:00">4:00 PM</option>
              <option value="16:30:00">4:30 PM</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label>Appointment Type *</label>
          <div style="display:flex;gap:12px;">
            <label style="flex:1;border:1.5px solid var(--teal);border-radius:10px;padding:16px;cursor:pointer;display:flex;align-items:center;gap:10px;background:#e0f5f5;">
              <input type="radio" name="appointment_type" value="in_person" checked> &#127973; In Person
            </label>
            <label style="flex:1;border:1.5px solid var(--gray-200);border-radius:10px;padding:16px;cursor:pointer;display:flex;align-items:center;gap:10px;">
              <input type="radio" name="appointment_type" value="telemedicine"> &#128187; Telemedicine
            </label>
          </div>
        </div>
        <div class="form-group"><label>Reason for Visit *</label><input type="text" name="reason" class="form-control" placeholder="e.g., Chest pain, routine checkup, follow-up" required></div>
        <div class="form-group"><label>Describe Your Symptoms</label><textarea name="symptoms" class="form-control" rows="4" placeholder="Describe what you are experiencing..." style="resize:vertical;"></textarea></div>
        <div style="background:var(--cream);border-radius:12px;padding:20px;margin-bottom:24px;font-size:14px;">
          <strong>&#128203; Before Your Appointment:</strong>
          <ul style="margin-top:8px;padding-left:20px;color:var(--gray-600);">
            <li>Bring your insurance card and photo ID</li>
            <li>List current medications you are taking</li>
            <li>Arrive 15 minutes early for paperwork</li>
          </ul>
        </div>
        <button type="submit" class="btn btn-primary" style="width:100%;justify-content:center;font-size:16px;padding:16px;" {% if not user.is_authenticated %}onclick="event.preventDefault();window.location='/patients/login/?next=/appointments/book/'"{% endif %}>&#128197; Confirm Appointment</button>
      </form>
    </div>
  </div>
</section>
{% endblock %}
{% block extra_js %}
<script>
document.getElementById("apptDate").min = new Date().toISOString().split("T")[0];
</script>
{% endblock %}